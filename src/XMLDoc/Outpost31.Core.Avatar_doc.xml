<!--
    u240818.0906_documentation

    Namespace
        Outpost31.Core.Avatar

    Classes
        AvatarData.cs
        ReturnObject.cs
-->

<Outpost31>

    <!--
        Outpost31.Core.Avatar.AvatarData class
    -->
    <Cs name="AvatarData">

        <!--
            Class documentation
        -->
        <AvatarData>
            <remarks>
                <para>
                    All of the imortant data sent from Avatar is stored here, and should only contain
                    the following Avatar-specific data:
                    <list type="bullet">
                        <item>The <see cref="SystemCode"/> </item>
                        <item>The <see cref="SentScriptParameter"/></item>
                        <item>The <see cref="SentOptionObject"/> </item>
                        <item>The <see cref="WorkOptionObject"/></item>
                        <item>The <see cref="ReturnOptionObject"/></item>
                    </list>
                    <br/>
                    When Tingen starts, this object is created and added to the <see cref="Session.TingenSession"/> object.
                </para>
            </remarks>
            <seealso href="https://github.com/spectrum-health-systems/Tingen-Documentation">Tingen/Outpost31 Documentation</seealso>
            <seealso href="https://github.com/spectrum-health-systems/Tingen-Documentation/blob/main/Static/Tingen-Session.md">Tingen Sessions</seealso>
        </AvatarData>

        <!--
            Outpost31.Core.Avatar.AvatarData.BuildObject()
        -->
        <BuildObject>
                <remarks>
                    <para>
                        The <see cref="SystemCode"/> is defined at runtime in <c>Tingen.Runscript()</c>.<br/>
                        <br/>
                        The <see cref="SentScriptParameter"/> is converted to lowercase so it is easier to compare against.<br/>
                        <br/>
                        The <see cref="WorkOptionObject"/> is cloned from the <see cref="SentOptionObject"/>, so it can be modified without affecting the original data.<br/>
                        <br/>
                        The <see cref="ReturnOptionObject"/> is initally set to <c>null</c>, and will be formatted/finalized prior to returning to Avatar.
                    </para>
            </remarks>
        </BuildObject>
    </Cs>


    <!--
        Outpost31.Core.Avatar.ReturnObject class
    -->
    <Cs name="ReturnObject">

        <!--
            Class documentation
        -->
        <ReturnObject>
            <remarks>
                <para>
                    Before returning an OptionObject to Avatar, it must be finalized, which is what this class does: it finalizes the OptionObject so it can be returned to Avatar.<br/>
                    <br/>
                    Please see the <a href="https://github.com/spectrum-health-systems/Tingen-Documentation">Tingen documentation</a> for more information.
                </para>
            </remarks>
        </ReturnObject>

        <!--
            Outpost31.Core.Avatar.ReturnObject.Finalize()
        -->
        <Finalize>
            <remarks>
                <para>
                    Before returning an OptionObject to Avatar, it must be <b>finalized</b>.<br/>
                    <br/>
                    Finalizing an OptionObject is a three part process:
                    <list type="number">
                        <item>Assign an <i>error code</i> to the returnOptionObject</item>
                        <item>Assign an <i>error message</i> to the returnOptionObject</item>
                        <item>Verify the returnOptionObject contains all required data</item>
                    </list>
                    Valid error codes include:
                    <list type="table">
                        <listheader>
                            <term>Error code</term>
                            <description>Description</description>
                        </listheader>
                        <item>
                            <term>0</term>
                            <description><b>Success</b> - Returns the OptionObject without a message</description>
                        </item>
                        <item>
                            <term>1</term>
                            <description><b>Error</b> - Stops the script from processing and displays an message with an "OK" button</description>
                        </item>
                        <item>
                            <term>2</term>
                            <description><b>OKCancel</b> - Displays a message with "OK" and "Cancel" buttons.</description>
                        </item>
                        <item>
                            <term>3</term>
                            <description><b>Info</b> - Displays an informational warning message with an "OK" button.</description>
                        </item>
                        <item>
                            <term>4</term>
                            <description><b>YesNo</b> - Displays a message with "Yes" and "No" buttons.</description>
                        </item>
                        <item>
                            <term>5</term>
                            <description><b>OpenURL</b> - Opens an URL in a browser</description>
                        </item>
                        <item>
                            <term>6</term>
                            <description><b>OpenForm</b> - Presents an OK/Cancel dialog to open a form (only be used on Form Load and Field events).</description>
                        </item>
                    </list>
                </para>
            </remarks>
            <seealso href="https://github.com/spectrum-health-systems/Tingen-Documentation/blob/main/Static/OptionObject.md">OptionObject Error Codes</seealso>
        </Finalize>
    </Cs>

</Outpost31>

